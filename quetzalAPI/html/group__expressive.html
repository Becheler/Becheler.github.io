<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QUETZAL: expressive</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QUETZAL
   </div>
   <div id="projectbrief">The Coalescence Template Library</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__expressive.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">expressive</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compile-time mathematical expressions optimization.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structquetzal_1_1expressive_1_1literal__factory.html">quetzal::expressive::literal_factory&lt; Args &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms <a href="https://stackoverflow.com/documentation/c%2b%2b/7836/literals#t=201709240552046831589">literals</a> into operator friendly classes.  <a href="structquetzal_1_1expressive_1_1literal__factory.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacdec2cd4ec959709f7a1891702c4d5dd"><td class="memTemplParams" colspan="2">template&lt;typename F &gt; </td></tr>
<tr class="memitem:gacdec2cd4ec959709f7a1891702c4d5dd"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__expressive_gacdec2cd4ec959709f7a1891702c4d5dd.html#gacdec2cd4ec959709f7a1891702c4d5dd">quetzal::expressive::use</a> (F f)</td></tr>
<tr class="memdesc:gacdec2cd4ec959709f7a1891702c4d5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms functions into operator friendly classes.  <a href="group__expressive_gacdec2cd4ec959709f7a1891702c4d5dd.html#gacdec2cd4ec959709f7a1891702c4d5dd">More...</a><br /></td></tr>
<tr class="separator:gacdec2cd4ec959709f7a1891702c4d5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58c778e9b9b37d66cacf0661990d0545"><td class="memTemplParams" colspan="2">template&lt;typename... Args, typename T &gt; </td></tr>
<tr class="memitem:ga58c778e9b9b37d66cacf0661990d0545"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__expressive_ga58c778e9b9b37d66cacf0661990d0545.html#ga58c778e9b9b37d66cacf0661990d0545">quetzal::expressive::literal</a> (T t)</td></tr>
<tr class="memdesc:ga58c778e9b9b37d66cacf0661990d0545"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms <a href="https://stackoverflow.com/documentation/c%2b%2b/7836/literals#t=201709240552046831589">literals</a> into operator friendly classes.  <a href="group__expressive_ga58c778e9b9b37d66cacf0661990d0545.html#ga58c778e9b9b37d66cacf0661990d0545">More...</a><br /></td></tr>
<tr class="separator:ga58c778e9b9b37d66cacf0661990d0545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga409b9a3537b841773d8c4f298ba7e849"><td class="memTemplParams" colspan="2">template&lt;typename F , typename... Fs&gt; </td></tr>
<tr class="memitem:ga409b9a3537b841773d8c4f298ba7e849"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__expressive_ga409b9a3537b841773d8c4f298ba7e849.html#ga409b9a3537b841773d8c4f298ba7e849">quetzal::expressive::compose</a> (F f, Fs...fs)</td></tr>
<tr class="memdesc:ga409b9a3537b841773d8c4f298ba7e849"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mathematical <a href="https://en.wikipedia.org/wiki/Function_composition">function composition</a>  <a href="group__expressive_ga409b9a3537b841773d8c4f298ba7e849.html#ga409b9a3537b841773d8c4f298ba7e849">More...</a><br /></td></tr>
<tr class="separator:ga409b9a3537b841773d8c4f298ba7e849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94be9d80e6f5f2281e4183109879a101"><td class="memTemplParams" colspan="2">template&lt;typename Inner , typename Outer &gt; </td></tr>
<tr class="memitem:ga94be9d80e6f5f2281e4183109879a101"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__expressive_ga94be9d80e6f5f2281e4183109879a101.html#ga94be9d80e6f5f2281e4183109879a101">quetzal::expressive::operator&gt;&gt;</a> (Inner inner, Outer outer)</td></tr>
<tr class="memdesc:ga94be9d80e6f5f2281e4183109879a101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mathematical <a href="https://en.wikipedia.org/wiki/Function_composition">function composition</a>  <a href="group__expressive_ga94be9d80e6f5f2281e4183109879a101.html#ga94be9d80e6f5f2281e4183109879a101">More...</a><br /></td></tr>
<tr class="separator:ga94be9d80e6f5f2281e4183109879a101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92089d2dbe2fb1d9ec4b8da47930b8ec"><td class="memTemplParams" colspan="2">template&lt;typename Inner , typename Outer &gt; </td></tr>
<tr class="memitem:ga92089d2dbe2fb1d9ec4b8da47930b8ec"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__expressive_ga92089d2dbe2fb1d9ec4b8da47930b8ec.html#ga92089d2dbe2fb1d9ec4b8da47930b8ec">quetzal::expressive::operator&lt;&lt;</a> (Outer outer, Inner inner)</td></tr>
<tr class="memdesc:ga92089d2dbe2fb1d9ec4b8da47930b8ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mathematical <a href="https://en.wikipedia.org/wiki/Function_composition">function composition</a>  <a href="group__expressive_ga92089d2dbe2fb1d9ec4b8da47930b8ec.html#ga92089d2dbe2fb1d9ec4b8da47930b8ec">More...</a><br /></td></tr>
<tr class="separator:ga92089d2dbe2fb1d9ec4b8da47930b8ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5999452049e3a9bc9710b318c56ab889"><td class="memTemplParams" colspan="2">template&lt;typename F1 , typename F2 , typename... Fs&gt; </td></tr>
<tr class="memitem:ga5999452049e3a9bc9710b318c56ab889"><td class="memTemplItemLeft" align="right" valign="top">constexpr auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__expressive_ga5999452049e3a9bc9710b318c56ab889.html#ga5999452049e3a9bc9710b318c56ab889">quetzal::expressive::chain</a> (F1 f1, F2 f2, Fs...fs)</td></tr>
<tr class="memdesc:ga5999452049e3a9bc9710b318c56ab889"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mathematical <a href="https://en.wikipedia.org/wiki/Function_composition">function composition</a>  <a href="group__expressive_ga5999452049e3a9bc9710b318c56ab889.html#ga5999452049e3a9bc9710b318c56ab889">More...</a><br /></td></tr>
<tr class="separator:ga5999452049e3a9bc9710b318c56ab889"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Compile-time mathematical expressions optimization. </p>
<h2>Motivations</h2>
<hr/>
<h3>Better express user-defined mathematical models</h3>
<p>The impact of environmental factors or spatial structure on demographic processes can be assessed by setting up mathematical models linking environmental and demographic quantities together. Obviously, the details of the functions used depend on the biological context and the modeler intuition, so there is <b>no do-it-all function</b> that could be implemented once and used in all possible contexts.</p>
<p>Inevitably, later or sooner the user would have to build its own modeling functions: all we can do is to propose <b>concise way to express them.</b></p>
<h3>Â Favor code modularity.</h3>
<p>In the context of <a href="https://en.wikipedia.org/wiki/Approximate_Bayesian_computation">ABC</a> it is expected that several of the function parameters change their values at runtime. One should prefer to pass around a whole expression with internally changing parameters values rather than passing multiples parameters everywhere in the code to propagate their new state (what would greatly hinder maintainability, especially since ABC approaches tend to favor models comparison thus code flexibility).</p>
<p>Expressive features allow to <b>encapsulate models details in an efficient way.</b></p>
<h3>Do it with minimal runtime cost</h3>
<p>To tackle both this multiplicity and the computational cost imposed by <a href="https://en.wikipedia.org/wiki/Approximate_Bayesian_computation">ABC</a> approaches, we integrate <a href="https://github.com/ambre-m/expressive">expressive</a>, a library that allows to compose mathematical expressions at compile time. Compile-time expressions manipulation allows the compiler to apply intra-procedural optimization (dead code elimination, branch prediction, induction variable elimination). Finally, it allows the compiler to simplify the expressions, or even deduce the final result of the function. This comes along with the other known <a href="https://en.wikipedia.org/wiki/Inline_expansion">benefits of eliminating a function call</a>, namely:</p><ul>
<li>It does not require function calling overhead.</li>
<li>It saves overhead of variables push/pop on the stack, while function calling.</li>
<li>It saves overhead of return call from a function.</li>
<li>It increases <a href="https://en.wikipedia.org/wiki/Interprocedural_optimization">locality of reference</a>.</li>
</ul>
<h2>Examples of biological interests</h2>
<hr/>
<h3>Representing dispersal kernels</h3>
<p>Representation of a dispersal kernel density involves some kind of mathematical composition. In the simple case where density is only a function of the geographic distance, the details of the distance computation can be separated from the details of the kernel used by composing two independently defined functions.</p>
<p>The inner function \( g : X^2 \rightarrow R\) would be the distance computation function between two points of the geographic space \(X\), and can be expressed in terms of a callable object having a <code>distance_type operator()(coord_type x, coord_type y)</code> interface.</p>
<p>The outer function \(f : R \rightarrow [0,1]\) could be any kind of density function defined on the distance metric space \(R\) and taking value in \([0,1] \), and can be defined in terms of a callable object having a <code>double operator()(distance_type d)</code> interface.</p>
<p>Without expressive, these two types could not be composed. With expressive, it becomes trivial: </p><div class="fragment"><div class="line"><span class="keyword">using</span> coord_type = int;</div><div class="line"><span class="keyword">using</span> distance_type = double;</div><div class="line"></div><div class="line"><span class="keyword">auto</span> g = [](coord_type x, coord_type y){</div><div class="line">    distance_type d = <span class="comment">// ...</span></div><div class="line">    <span class="keywordflow">return</span> d;</div><div class="line"> }</div><div class="line"></div><div class="line"><span class="keyword">auto</span> f = [](distance_type d){</div><div class="line">  <span class="comment">// ...</span></div><div class="line">   <span class="keywordflow">return</span> proba;</div><div class="line"> }</div><div class="line"></div><div class="line"><span class="keyword">auto</span> kernel = <a class="code" href="group__expressive_ga409b9a3537b841773d8c4f298ba7e849.html#ga409b9a3537b841773d8c4f298ba7e849">quetzal::expressive::compose</a>(f,g);</div></div><!-- fragment --><h3>Representing environmental quantities as functions of space and time.</h3>
<p>In the framework of complex coalescence processes, a major benefit of expressive is the possibility to express and compose quantities that are functions of space and time.</p>
<p>The geography module, via the DiscreteLandscape class template, provides lightweight function objects of space and time which are callable with GeographicCoordinates and an user-defined time argument to access environmental values. These little objects can be composed into more complex expressions using expressive. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <a class= "footerinfo" href="https://github.com/Becheler/quetzal/wiki">Wiki</a>
  <a class= "footerinfo" href="https://becheler.github.io/">Maintainer</a>
  <a class= "footerinfo" href="mailto:Arnaud.Becheler@egce.cnrs-gif.fr">Contact</a>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-106771332-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
