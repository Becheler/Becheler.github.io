\hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{}\doxysection{quetzal\+::Forward\+Backward\+Spatially\+Explicit$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$ Class Template Reference}
\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit}\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}


Discrete-\/time coalescence simulator in a discrete spatially explicit landscape.  




{\ttfamily \#include $<$Forward\+Backward\+Spatially\+Explicit.\+h$>$}



Inheritance diagram for quetzal\+::Forward\+Backward\+Spatially\+Explicit$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=258pt]{classquetzal_1_1ForwardBackwardSpatiallyExplicit__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for quetzal\+::Forward\+Backward\+Spatially\+Explicit$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=258pt]{classquetzal_1_1ForwardBackwardSpatiallyExplicit__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_aaee17ac8ea32a5db23fc068971f22564}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_aaee17ac8ea32a5db23fc068971f22564}} 
using {\bfseries coord\+\_\+type} = Space
\item 
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a5fbd956a83e7e8ee9e28e203c6bfa177}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a5fbd956a83e7e8ee9e28e203c6bfa177}} 
using {\bfseries time\+\_\+type} = Time
\item 
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ad266a2e607278b869212d8ee946b89f4}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ad266a2e607278b869212d8ee946b89f4}} 
using {\bfseries dispersal\+\_\+policy\+\_\+type} = Dispersal\+Policy
\item 
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a3a258fd2950e2d974457c6e8dd941e5e}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a3a258fd2950e2d974457c6e8dd941e5e}} 
using {\bfseries N\+\_\+value\+\_\+type} = typename Dispersal\+Policy\+::value\+\_\+type
\item 
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a8ebfb9ce69578deb566ff40b2676088e}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a8ebfb9ce69578deb566ff40b2676088e}} 
{\footnotesize template$<$typename tree\+\_\+type $>$ }\\using {\bfseries forest\+\_\+type} = \mbox{\hyperlink{classquetzal_1_1coalescence_1_1Forest}{quetzal\+::coalescence\+::\+Forest}}$<$ coord\+\_\+type, tree\+\_\+type $>$
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_adb8474c5c66991e5c7be6226c42a8b6f}{Forward\+Backward\+Spatially\+Explicit}} (coord\+\_\+type x\+\_\+0, N\+\_\+value\+\_\+type N\+\_\+0, unsigned int nb\+\_\+generations)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a8de3f9967123cc24c403deb79871c232}{pop\+\_\+size\+\_\+history}} () const noexcept
\begin{DoxyCompactList}\small\item\em Read-\/only access to the population size history. @detail Designed to be used for composing growth expression. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Generator , typename Growth , typename Dispersal $>$ }\\void \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a1c02f6837a041942a963c2b3e2c227a1}{simulate\+\_\+forward\+\_\+demography}} (Growth growth, Dispersal kernel, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Simulate the forward-\/in-\/time demographic expansion. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger , typename Generator $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a429984c5d78e2b1385749d42b79df030}{make\+\_\+forest\+\_\+and\+\_\+coalesce\+\_\+along\+\_\+spatial\+\_\+history}} (std\+::map$<$ coord\+\_\+type, unsigned int $>$ sample, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Initlize a forest based on sample counts then coalesce the forest along the spatial history, then stops and return an incomplete forest. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger , typename Generator $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ab1daf110230673bc437266dc03b9d784}{make\+\_\+forest\+\_\+using\+\_\+sampling\+\_\+time\+\_\+and\+\_\+coalesce\+\_\+along\+\_\+spatial\+\_\+history}} (std\+::map$<$ coord\+\_\+type, unsigned int $>$ sample, time\+\_\+type const \&sampling\+\_\+time, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Initlize a forest based on sample counts, forwarding the sampling time to the forest contructor. Then coalesce the forest along the spatial history, then stops and return a possibly incomplete forest. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger , typename Generator , typename F , typename Tree , typename U $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_afac51da28d829d5f401e9cdda8f6616f}{coalesce\+\_\+along\+\_\+spatial\+\_\+history}} (\mbox{\hyperlink{classquetzal_1_1coalescence_1_1Forest}{forest\+\_\+type}}$<$ Tree $>$ forest, F binary\+\_\+op, Generator \&gen, U make\+\_\+tree) const
\begin{DoxyCompactList}\small\item\em Coalesce a forest of nodes conditionally to the simulated demography. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename Generator $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_aff3306d2cf34dfb9577fc2e3b0b1b52f}{coalesce\+\_\+to\+\_\+mrca}} (std\+::map$<$ coord\+\_\+type, unsigned int $>$ sample, time\+\_\+type const \&sampling\+\_\+time, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Create a forest from a sample and coalesce it conditionally to the simulated demography. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename Generator $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a985f808806ff68db361bca5dc0d137ae}{coalesce\+\_\+to\+\_\+mrca}} (std\+::map$<$ coord\+\_\+type, unsigned int $>$ sample, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Create a forest from a sample and coalesce it conditionally to the simulated demography. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename Generator , typename F $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ab776ee1ea8d187fbc70e15ab93b91c49}{coalesce\+\_\+to\+\_\+mrca}} (std\+::map$<$ coord\+\_\+type, unsigned int $>$ sample, time\+\_\+type const \&sampling\+\_\+time, F leaf\+\_\+name, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Create a forest from a sample giving name to tips, then coalesce them conditionally to the simulated demography. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename T , typename F1 , typename F2 , typename Generator $>$ }\\auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a3d217cc52c5126f77207a37a2adcf040}{coalesce\+\_\+to\+\_\+mrca}} (std\+::vector$<$ T $>$ sample, time\+\_\+type const \&sampling\+\_\+time, F1 get\+\_\+location, F2 get\+\_\+name, Generator \&gen)
\begin{DoxyCompactList}\small\item\em Create a forest from a sample then coalesce them conditionally to the simulated demography. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename Space, typename Time, typename Dispersal\+Policy, typename Coalescence\+Policy, typename Storage\+Policy$>$\newline
class quetzal\+::\+Forward\+Backward\+Spatially\+Explicit$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$}

Discrete-\/time coalescence simulator in a discrete spatially explicit landscape. 

This simulator consists in a forward demographic simulation of population growth and migration, after what a backward coalescent simulation is performed that traces back the ancestry of a sample of gene copies sampled in one or more populations. Most Recent Common ancestor is not always fond in the time span of the spatial history, so if the chosen Coalescence\+Policy implements the required behavior, ancestry can be simulated in the more distant past using another model like the \mbox{\hyperlink{classquetzal_1_1DiscreteTimeWrightFisher}{Discrete\+Time\+Wright\+Fisher}} model, to find the M\+R\+CA. Details concerning the mergers (binary mergers, simultaneous multiple mergers) can be controlled using the relevant Merger policy class when calling a coalescence function of the class interface. 
\begin{DoxyTemplParams}{Template Parameters}
{\em Space} & deme identifiers (like the populations geographic coordinates) \\
\hline
{\em Time} & time identifier (like an integer representing the year) \\
\hline
{\em Strategy} & a template class argument (e.\+g. mass\+\_\+based, individual\+\_\+based) that indicates how dispersal should be defined in terms of demographic expansion algorithms. Strategy class implements the details (computing migrations probabilites as a function of the distance for example) whereas template specialization of the internal history\+\_\+type class defines different migration algorithms. \\
\hline
{\em Coalescence\+Policy} & a policy class for the demographic expansion. \\
\hline
\end{DoxyTemplParams}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_adb8474c5c66991e5c7be6226c42a8b6f}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_adb8474c5c66991e5c7be6226c42a8b6f}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!ForwardBackwardSpatiallyExplicit@{ForwardBackwardSpatiallyExplicit}}
\index{ForwardBackwardSpatiallyExplicit@{ForwardBackwardSpatiallyExplicit}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{ForwardBackwardSpatiallyExplicit()}{ForwardBackwardSpatiallyExplicit()}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
\mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::\mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{Forward\+Backward\+Spatially\+Explicit}} (\begin{DoxyParamCaption}\item[{coord\+\_\+type}]{x\+\_\+0,  }\item[{N\+\_\+value\+\_\+type}]{N\+\_\+0,  }\item[{unsigned int}]{nb\+\_\+generations }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em x\+\_\+0} & Initialization coordinate. \\
\hline
{\em N\+\_\+0} & Population size at intialization \\
\hline
{\em nb\+\_\+generations} & number of generations of the spatial process \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_afac51da28d829d5f401e9cdda8f6616f}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_afac51da28d829d5f401e9cdda8f6616f}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!coalesce\_along\_spatial\_history@{coalesce\_along\_spatial\_history}}
\index{coalesce\_along\_spatial\_history@{coalesce\_along\_spatial\_history}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{coalesce\_along\_spatial\_history()}{coalesce\_along\_spatial\_history()}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger , typename Generator , typename F , typename Tree , typename U $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::coalesce\+\_\+along\+\_\+spatial\+\_\+history (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classquetzal_1_1coalescence_1_1Forest}{forest\+\_\+type}}$<$ Tree $>$}]{forest,  }\item[{F}]{binary\+\_\+op,  }\item[{Generator \&}]{gen,  }\item[{U}]{make\+\_\+tree }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Coalesce a forest of nodes conditionally to the simulated demography. 

\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a985f808806ff68db361bca5dc0d137ae}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a985f808806ff68db361bca5dc0d137ae}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!coalesce\_to\_mrca@{coalesce\_to\_mrca}}
\index{coalesce\_to\_mrca@{coalesce\_to\_mrca}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{coalesce\_to\_mrca()}{coalesce\_to\_mrca()}\hspace{0.1cm}{\footnotesize\ttfamily [1/4]}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename Generator $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::coalesce\+\_\+to\+\_\+mrca (\begin{DoxyParamCaption}\item[{std\+::map$<$ coord\+\_\+type, unsigned int $>$}]{sample,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Create a forest from a sample and coalesce it conditionally to the simulated demography. 


\begin{DoxyTemplParams}{Template Parameters}
{\em Merger} & a coalescence merger to use \\
\hline
{\em Generator} & a random number Generator\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em sample} & the number of gene copies at each location @gen a random number generator \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ab776ee1ea8d187fbc70e15ab93b91c49}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ab776ee1ea8d187fbc70e15ab93b91c49}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!coalesce\_to\_mrca@{coalesce\_to\_mrca}}
\index{coalesce\_to\_mrca@{coalesce\_to\_mrca}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{coalesce\_to\_mrca()}{coalesce\_to\_mrca()}\hspace{0.1cm}{\footnotesize\ttfamily [2/4]}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename Generator , typename F $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::coalesce\+\_\+to\+\_\+mrca (\begin{DoxyParamCaption}\item[{std\+::map$<$ coord\+\_\+type, unsigned int $>$}]{sample,  }\item[{time\+\_\+type const \&}]{sampling\+\_\+time,  }\item[{F}]{leaf\+\_\+name,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Create a forest from a sample giving name to tips, then coalesce them conditionally to the simulated demography. 


\begin{DoxyTemplParams}{Template Parameters}
{\em Generator} & a random number Generator \\
\hline
{\em F} & a unary operation with signature equivalent to \textquotesingle{}std\+::string fun(coord\+\_\+type const\& x, time\+\_\+type const\& t)\textquotesingle{}\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em sample} & the number of gene copies at each location \\
\hline
{\em sampling\+\_\+time} & the time of sampling\+\_\+time \\
\hline
{\em leaf\+\_\+name} & a functor assigning a name to a tip as a function of its location and of sampling time. @gen a random number generator \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_aff3306d2cf34dfb9577fc2e3b0b1b52f}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_aff3306d2cf34dfb9577fc2e3b0b1b52f}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!coalesce\_to\_mrca@{coalesce\_to\_mrca}}
\index{coalesce\_to\_mrca@{coalesce\_to\_mrca}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{coalesce\_to\_mrca()}{coalesce\_to\_mrca()}\hspace{0.1cm}{\footnotesize\ttfamily [3/4]}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename Generator $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::coalesce\+\_\+to\+\_\+mrca (\begin{DoxyParamCaption}\item[{std\+::map$<$ coord\+\_\+type, unsigned int $>$}]{sample,  }\item[{time\+\_\+type const \&}]{sampling\+\_\+time,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Create a forest from a sample and coalesce it conditionally to the simulated demography. 


\begin{DoxyTemplParams}{Template Parameters}
{\em Merger} & a coalescence merger to use \\
\hline
{\em Generator} & a random number Generator\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em sample} & the number of gene copies at each location \\
\hline
{\em sampling\+\_\+time} & the time of sampling\+\_\+time to build the make\+\_\+forest coalescence policy function @gen a random number generator \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a3d217cc52c5126f77207a37a2adcf040}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a3d217cc52c5126f77207a37a2adcf040}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!coalesce\_to\_mrca@{coalesce\_to\_mrca}}
\index{coalesce\_to\_mrca@{coalesce\_to\_mrca}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{coalesce\_to\_mrca()}{coalesce\_to\_mrca()}\hspace{0.1cm}{\footnotesize\ttfamily [4/4]}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger  = quetzal\+::coalescence\+::\+Simultaneous\+Multiple\+Merger$<$quetzal\+::coalescence\+::occupancy\+\_\+spectrum\+::on\+\_\+the\+\_\+fly$>$, typename T , typename F1 , typename F2 , typename Generator $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::coalesce\+\_\+to\+\_\+mrca (\begin{DoxyParamCaption}\item[{std\+::vector$<$ T $>$}]{sample,  }\item[{time\+\_\+type const \&}]{sampling\+\_\+time,  }\item[{F1}]{get\+\_\+location,  }\item[{F2}]{get\+\_\+name,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Create a forest from a sample then coalesce them conditionally to the simulated demography. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & type of an individual \\
\hline
{\em F1} & a unary operation with signature equivalent to \textquotesingle{}coord\+\_\+type fun(const T\& i)\textquotesingle{} \\
\hline
{\em F2} & a unary operation with signature equivalent to \textquotesingle{}std\+::string fun(const T\& i)\textquotesingle{} \\
\hline
{\em Generator} & a random number Generator\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em sample} & a collection of individuals (gene copies) \\
\hline
{\em sampling\+\_\+time} & the time of sampling\+\_\+time \\
\hline
{\em get\+\_\+location} & a unary operation taking a sampled individual of type T as an argument and returning its geographic location \\
\hline
{\em get\+\_\+name} & a functor taking a sampled individual of type T as an argument and returning an identifier @gen a random number generator \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a429984c5d78e2b1385749d42b79df030}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a429984c5d78e2b1385749d42b79df030}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!make\_forest\_and\_coalesce\_along\_spatial\_history@{make\_forest\_and\_coalesce\_along\_spatial\_history}}
\index{make\_forest\_and\_coalesce\_along\_spatial\_history@{make\_forest\_and\_coalesce\_along\_spatial\_history}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{make\_forest\_and\_coalesce\_along\_spatial\_history()}{make\_forest\_and\_coalesce\_along\_spatial\_history()}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger , typename Generator $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::make\+\_\+forest\+\_\+and\+\_\+coalesce\+\_\+along\+\_\+spatial\+\_\+history (\begin{DoxyParamCaption}\item[{std\+::map$<$ coord\+\_\+type, unsigned int $>$}]{sample,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Initlize a forest based on sample counts then coalesce the forest along the spatial history, then stops and return an incomplete forest. 

\begin{DoxyReturn}{Returns}
A possibly incompletely coalesced forest. 
\end{DoxyReturn}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ab1daf110230673bc437266dc03b9d784}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_ab1daf110230673bc437266dc03b9d784}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!make\_forest\_using\_sampling\_time\_and\_coalesce\_along\_spatial\_history@{make\_forest\_using\_sampling\_time\_and\_coalesce\_along\_spatial\_history}}
\index{make\_forest\_using\_sampling\_time\_and\_coalesce\_along\_spatial\_history@{make\_forest\_using\_sampling\_time\_and\_coalesce\_along\_spatial\_history}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{make\_forest\_using\_sampling\_time\_and\_coalesce\_along\_spatial\_history()}{make\_forest\_using\_sampling\_time\_and\_coalesce\_along\_spatial\_history()}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Merger , typename Generator $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::make\+\_\+forest\+\_\+using\+\_\+sampling\+\_\+time\+\_\+and\+\_\+coalesce\+\_\+along\+\_\+spatial\+\_\+history (\begin{DoxyParamCaption}\item[{std\+::map$<$ coord\+\_\+type, unsigned int $>$}]{sample,  }\item[{time\+\_\+type const \&}]{sampling\+\_\+time,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Initlize a forest based on sample counts, forwarding the sampling time to the forest contructor. Then coalesce the forest along the spatial history, then stops and return a possibly incomplete forest. 

\begin{DoxyReturn}{Returns}
A possibly incompletely coalesced forest. 
\end{DoxyReturn}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a8de3f9967123cc24c403deb79871c232}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a8de3f9967123cc24c403deb79871c232}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!pop\_size\_history@{pop\_size\_history}}
\index{pop\_size\_history@{pop\_size\_history}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{pop\_size\_history()}{pop\_size\_history()}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
auto \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::pop\+\_\+size\+\_\+history (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Read-\/only access to the population size history. @detail Designed to be used for composing growth expression. 

\begin{DoxyReturn}{Returns}
a functor with signature {\ttfamily N\+\_\+value\+\_\+type fun(coord\+\_\+type const\& x, time\+\_\+type const\& t)} giving the population size in deme $x$ at time $t$. 
\end{DoxyReturn}
\mbox{\Hypertarget{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a1c02f6837a041942a963c2b3e2c227a1}\label{classquetzal_1_1ForwardBackwardSpatiallyExplicit_a1c02f6837a041942a963c2b3e2c227a1}} 
\index{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}!simulate\_forward\_demography@{simulate\_forward\_demography}}
\index{simulate\_forward\_demography@{simulate\_forward\_demography}!quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$@{quetzal::ForwardBackwardSpatiallyExplicit$<$ Space, Time, DispersalPolicy, CoalescencePolicy, StoragePolicy $>$}}
\doxysubsubsection{\texorpdfstring{simulate\_forward\_demography()}{simulate\_forward\_demography()}}
{\footnotesize\ttfamily template$<$typename Space , typename Time , typename Dispersal\+Policy , typename Coalescence\+Policy , typename Storage\+Policy $>$ \\
template$<$typename Generator , typename Growth , typename Dispersal $>$ \\
void \mbox{\hyperlink{classquetzal_1_1ForwardBackwardSpatiallyExplicit}{quetzal\+::\+Forward\+Backward\+Spatially\+Explicit}}$<$ Space, Time, Dispersal\+Policy, Coalescence\+Policy, Storage\+Policy $>$\+::simulate\+\_\+forward\+\_\+demography (\begin{DoxyParamCaption}\item[{Growth}]{growth,  }\item[{Dispersal}]{kernel,  }\item[{Generator \&}]{gen }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Simulate the forward-\/in-\/time demographic expansion. 


\begin{DoxyTemplParams}{Template Parameters}
{\em Growth} & a growth functor, see param growth for details. \\
\hline
{\em Dispersal} & a dispersal kernel, see param kernel for details. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em growth} & a functor simulating $\tilde{N}_{x}^{t}$. The functor can possibly make use of pop\+\_\+size\+\_\+history. The signature of the function should be equivalent to the following\+: {\ttfamily unsigned int sim\+\_\+growth(\+V \&gen, const coord\+\_\+type \&x, const time\+\_\+type \&t);} \\
\hline
{\em kernel} & a functor representing the dispersal location kernel that simulates the coordinate of the next location conditionally to the current location $x$. The signature should be equivalent to {\ttfamily coord\+\_\+type kernel(\+V \&gen, const coord\+\_\+type \&x, const time\+\_\+type \&t);} \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
quetzal/include/quetzal/simulator/Forward\+Backward\+Spatially\+Explicit.\+h\end{DoxyCompactItemize}
