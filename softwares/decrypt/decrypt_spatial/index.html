<!DOCTYPE html>
<html lang="en">

<!-- Include header -->
<head>
	<meta charset="utf-8">
	<title>Decrypt - Arnaud Becheler - Personal website</title>

  <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="Arnaud Becheler - Personal website" property="og:site_name">
  
    <meta content="Decrypt" property="og:title">
  
  
    <meta content="article" property="og:type">
  
  
    <meta content="spatially explicit coalescence process" property="og:description">
  
  
    <meta content="https://Becheler.github.io/softwares/decrypt/decrypt_spatial/" property="og:url">
  
  
  
    <meta content="https://Becheler.github.io/assets/img/arnaud-becheler.png" property="og:image">
  
  
  

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@">
  
    <meta name="twitter:title" content="Decrypt">
  
  
    <meta name="twitter:url" content="https://Becheler.github.io/softwares/decrypt/decrypt_spatial/">
  
  
    <meta name="twitter:description" content="spatially explicit coalescence process">
  
  
    <meta name="twitter:image:src" content="https://Becheler.github.io/assets/img/arnaud-becheler.png">
  

	<meta name="description" content="spatially explicit coalescence process">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/assets/img/favicon/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicon/apple-touch-icon-144x144.png">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#263959">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#263959">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#263959">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700|Lato:300,400,700&display=swap" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/my-softwares.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">
	<link rel="stylesheet" href="/assets/css/my_stylesheet.css">
	<!-- Tangerine font -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Tangerine:wght@700&display=swap" rel="stylesheet"> 
</head>


*<!-- Mathjax support -->

<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>



<!-- Default body -->
<body>
  
  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/"><img src="/assets/img/arnaud-becheler.png" alt="Arnaud Becheler"></a>
      </div>
      <div class="author-name">Arnaud Becheler</div>
      <p>A French Software Engineer, always happy to learn about phylogeography and programming!</p>
    </div>
  </header> <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">Softwares</h3>
      <ul>
        <li><a href="https://github.com/Becheler/quetzal-EGGS" target="_blank"><i class="icon icon-quetzal-eggs--fa" title="Quetzal-EGGS" aria-hidden="true"></i></a></li>
        <li><a href="/softwares/quetzal-CoalTL/home" target="_blank"><i class="icon icon-quetzal-coaltl-fa" title="Quetzal-CoalTL" aria-hidden="true"></i></a></li>
        <li><a href="https://github.com/Becheler/quetzal-CRUMBS" target="_blank"><i class="icon icon-quetzal-crumbs-fa" title="Quetzal-CRUMBS" aria-hidden="true"></i></a></li>
        <li><a href="https://github.com/Becheler/decrypt" target="_blank"><i class="icon icon-decrypt_fa" title="Decrypt" aria-hidden="true"></i></a></li>
      </ul>
      <section class="contact">
        <h3 class="contact-title"> About me </h3>
        <ul>
          <li><a href="/pages/about-me/index.html" target="_blank"><i class="fa fa-youtube-play" title="Presentations" aria-hidden="true"></i></a></li>
          <li><a href="/assets/pdfs/cv.pdf" target="_blank"><i class="fa fa-file-pdf-o" title="CV" aria-hidden="true"></i></a></li>
          <li><a href="https://scholar.google.fr/citations?user=zEwT-zUAAAAJ&hl=en&oi=ao" target="_blank"><i class="fa fa-graduation-cap" title="My Google Scholar" aria-hidden="true"></i></a></li>
          
        </ul>
    </section> <!-- End Section Resume -->
    <section class="contact">
      <h3 class="contact-title">Find me on</h3>
      <ul>
        
        
        
        
          <li class="github"><a href="http://github.com/" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a></li>
        
        
        
          <li class="linkedin"><a href="https://in.linkedin.com/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
        
      </ul>
    </section> <!-- End Section Contact -->
    <div class="copyright">
      <p>2022 &copy; Arnaud Becheler</p>
    </div>
  </footer> <!-- End Footer -->
</aside> <!-- End Sidebar -->
<div class="content-box clearfix">
  <h1 id="forward-time-demographic-process">Forward time demographic process</h1>

<p>In this tutorial you will learn about the principal aspects of spatially explicit
coalescence models. You will here have a look into the forward time demographic
process to understand how to model the fact that geographic distance and environmental
conditions can affect dispersal and reproduction.
In a second part of the tutorial, you will see how these model features can affect
coalescence process and genetic diversity.</p>

<h2 id="modeling-life-cycles">Modeling life cycles</h2>

<p>During a lifetime, organisms can go through many different stages. Some stages may
be very specific to a type of organism, other stages can be heavily impacted by
environmental conditions, other stages can be density-dependent…</p>

<blockquote>
  <p>Task: consider your favorite organism and take few minutes to imagine how you would
 model the lifecycle of a single individual:</p>
  <ul>
    <li>What are the main stages?</li>
    <li>How much time does the individual stay in each stage? Is there variability?</li>
    <li>How environmental conditions and other factors affect the survival at each stage?</li>
    <li>What defines the transition to the next stage?</li>
  </ul>
</blockquote>

<p>Even if it is feasible to include any number of stages in a simulation model, it is
 not always relevant: adding a stage like the <em>egg</em> form for an insect:</p>
<ul>
  <li>increases the complexity of the model</li>
  <li>increases the computational time,</li>
  <li>may require some uncomfortable assumptions</li>
  <li>reduce the portability of the model to other organisms</li>
  <li>and can possible add more parameters to estimate like
the mortality rate during the egg form.</li>
</ul>

<p>This can explain why we will consider here a very light version of a generation-by-generation lifecycle:</p>
<ul>
  <li>parents reproduce</li>
  <li>parents die</li>
  <li>children disperse</li>
</ul>

<p>Simplest. Cycle. Ever.</p>

<p>It means that reproduction and dispersal will be considered here as the main demographic processes
 shaping genetic diversity: this not always the case!</p>

<h2 id="modeling-reproduction">Modeling reproduction</h2>

<h3 id="the-old-example-of-a-bacteria-population-in-an-infinite-plate">The old example of a bacteria population in an infinite plate.</h3>

<p>Consider an initial bacteria that reproduces, having 2 children. The parent dies.
Population size is now 2.
Each child has then again 2 children. Parents die. Population size is now 4…</p>

<p>At this rate, the population obviously colonizes the entire universe. Simple, but
not realistic. There is always a number of factors limiting the expansion of a colony.</p>

<blockquote>
  <p>Task:
In your favorite biological organism, identify some of these factors.
Imagine how these factors could be integrated in a more formal way.</p>

  <p>Alert: spoilers ahead.</p>
</blockquote>

<h3 id="a-more-formal-way-to-integrate-limiting-factors-the-logistic-growth">A more formal way to integrate limiting factors: the logistic growth</h3>

<p>The logistic function can be used to set a limit to the size that a population can
reach in a given environment. It introduces two quantities:</p>
<ul>
  <li>the growth rate $r$, related to the average fecundity of the population</li>
  <li>the carrying capacity $K$, that is the maximal number of individuals that can be supported.</li>
</ul>

<p>The following picture shows how the size of a population changes through time,
with carrying capacity $K=500$, for different values of $r$:</p>

<p><img src="https://Becheler.github.io/pictures/logistic.png" alt="logistic growth" /></p>

<h3 id="mathematical-description">Mathematical description</h3>

<p>Let’s consider a single population where $N$ parents reproduce then die in an environment
that has limited resources.</p>

<p>A possible expression of the number of children $\tilde{N}$ would be:</p>

<p>\(\tilde{N} = \frac{N.(1+r)}{1+\frac{rN}{K}}\),</p>

<blockquote>
  <p>Type in the terminal:</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model_1 --config examples/config_1.ctl --landscape examples/australia_precipitation_6032.tif
</code></pre></div>  </div>
  <p>The first command line runs a demographic simulation across Australia.
The second command line generates an animation to visualize the results.
Observe the characteristics of the demographic history:</p>
  <ul>
    <li>Speed of the expansion front</li>
    <li>Total population size over the landscape</li>
    <li>Does the process reach a stable state?</li>
  </ul>

  <p>Now try different configurations:</p>
  <ul>
    <li>Open the configuration file and modify the growth rate and the carrying capacity in order to increase or decrease the speed of the expansion front</li>
    <li>What conclusion can you make?</li>
    <li>Make a list of your biological systems of interest that match/don’t match this model.</li>
    <li>What aspect(s) of the demographic process could be changed to give a better match?</li>
  </ul>
</blockquote>

<p><img src="https://Becheler.github.io/pictures/decrypt/animation_1.gif" alt="expansion 1" /></p>

<h2 id="another-model-of-dispersal">Another model of dispersal</h2>

<p>Instead of splitting a population of deme across neighboring cells, one can also, using Quetzal,
simulate the dispersal of each individual by sampling their destination in a Gaussian kernel centered
on the departure cell.</p>

<blockquote>
  <p>Type in the terminal:</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model_2 --config examples/config_2.ctl --landscape examples/australia_precipitation_6032.tif
</code></pre></div>  </div>
</blockquote>

<p><img src="https://Becheler.github.io/pictures/decrypt/animation_2.gif" alt="expansion 1" /></p>

<blockquote>
  <p>Task:</p>
  <ul>
    <li>In what context should we prefer this dispersal mode?</li>
    <li>When would it be overkill?</li>
    <li>Do you know other dispersal forms that could be used?</li>
    <li>Check <a href="https://books.google.fr/books?hl=en&amp;lr=&amp;id=s3EVDAAAQBAJ&amp;oi=fnd&amp;pg=PA187&amp;dq=nathan+dispersal+kernel+review&amp;ots=LKrBHv_VDo&amp;sig=vhJcyp8wJmazryll68rvU9SK4Ms#v=onepage&amp;q=nathan%20dispersal%20kernel%20review&amp;f=false">this review of dispersal kernels by Nathan et al., 2012</a></li>
    <li>What would you use for your organism of interest?</li>
  </ul>
</blockquote>

<h2 id="adding-environmental-heterogeneity">Adding environmental heterogeneity</h2>

<p>In a third version of the model, we will introduce landscape heterogeneity into the model.
There are at least three ways to do so:</p>
<ul>
  <li>say that $r$ depends on the local environmental conditions</li>
  <li>say that $K$ depends on the local environmental conditions</li>
  <li>say that migration depends on the local and neighboring environmental conditions</li>
</ul>

<blockquote>
  <p>Task:</p>
  <ul>
    <li>What do you expect each option to change in the demographic dynamics?</li>
    <li>In the coalescence process?</li>
  </ul>
</blockquote>

<h3 id="defining-niche-functions-in-the-reproduction-model">Defining niche functions in the reproduction model</h3>

<p>By <em>niche functions</em>, we mean any model quantity that is linked to environmental
quantities.</p>

<p>For example the following function is what we would call a niche function: the growth rate
is a function of the temperature.</p>

<p><img src="https://Becheler.github.io/pictures/niche.png" alt="niche function" /></p>

<p>Usually in demogenetic models, the “true” niche functions are not precisely known,
so their forms have to be inferred. In the previous picture, we would typically try to estimate
the parameters $T_{opt}$, $T_{min}$ and $T_{max}$.</p>

<p>Formally, let’s pretend here that the number of descendants \(\tilde{N}_{x}^{t}\) in each deme can be sampled in a
distribution conditionally to a function of the the local density of parents,
for example</p>

<p>\(\tilde{N}_{x}^{t} \sim Poisson(g(x,t))\),</p>

<p>where $g$ can be for example a discrete version of the logistic growth:</p>

\[\begin{array}{cc|ccc}
    g &amp; : &amp; \mathbb{X}\times \mathbb{N} &amp; \mapsto &amp; \mathbb{R}^{+} \\
      &amp;   &amp;          (x,t)               &amp; \mapsto &amp; \frac{N_{x}^{t}\times(1+r(x,t))}{1+\frac{r(x,t)\times N_{x}^{t}}{K(x,t)}}  ~. \\
\end{array}\]

<p>The $r$, respectively $k$, term is the growth rate, respectively the carrying capacity,
defined as a function of the environmental quantities with parameter $\theta$:</p>

\[\begin{array}{ccccl}
K  &amp; : &amp; \mathbb{X}\times \mathbb{N} &amp; \mapsto &amp; \mathbb{R}^{+} \\
   &amp;   &amp;    (x,t)       &amp; \mapsto &amp; f_{K}^{\theta}(E(x,t))~, \\
\end{array}\]

\[\begin{array}{ccccl}
r  &amp; : &amp; \mathbb{X} &amp; \mapsto &amp; \mathbb{R} \\
   &amp;   &amp;    (x,t)       &amp; \mapsto &amp; f_{r}^{\theta}(E(x,t)) ~. \\
\end{array}\]

<blockquote>
  <p>Type in the terminal:</p>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model_3 --config examples/config_3.ctl --landscape examples/australia_precipitation_6032.tif
</code></pre></div>  </div>
</blockquote>

<p><img src="https://Becheler.github.io/pictures/decrypt/animation_3.gif" alt="expansion 3" /></p>

<h1 id="references">References</h1>

<p>Nathan, R., Klein, E. K., Robledo-Arnuncio, J. J., &amp; Revilla, E. (2012). Dispersal kernels. Dispersal ecology and evolution, 187-210.</p>

</div>

  </div>
  <!-- We want analytics -->
  <!-- Enables suupport for Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-106771332-1', 'auto');
  ga('send', 'pageview');
</script> <!-- End Analytics -->

</body>

</html>
